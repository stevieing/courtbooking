<%# TODO: This needs a presenter to improve the whole thing %>
<%= content_tag :section, id: id do %>
  <%= content_tag :table do %>
    <%= content_tag(:caption, object.heading) %>
    <% object.rows.each do |row_key, row| %>
      <%= content_tag :tr, class: row.html_class do %>
        <% row.cells.each do |cell_key, cell| %>
          <% if row_key == :header || row_key == :footer %>
            <%= content_tag(:th, cell.text) %>
          <% else %>
            <% unless cell.blank? %>
              <%= content_tag :td, class: cell.html_class, rowspan: cell.span do %>
                <% if cell.link? %>
                  <%= link_to cell.text, cell.link, class: cell.html_class, remote: remote  %>
                <% else %>
                  <%= cell.text %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>